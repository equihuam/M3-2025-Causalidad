[
  {
    "objectID": "presentaciones.html",
    "href": "presentaciones.html",
    "title": "M3-Presentaciones",
    "section": "",
    "text": "Leyes de la Ciencia\n\n\nDiseño de estudios y experimentos\n\n\n\npresentación\n\n\n\n\n\n\n\n\n\n28 ene 2025\n\n\nMiguel Equihua, Elio Lagunes\n\n\n\n\n\n\n\n\n\n\n\n\nModelo Estadístico Lineal\n\n\nmodelación y prueba de hipótesis\n\n\n\npresentación\n\n\n\n\n\n\n\n\n\n28 ene 2025\n\n\nMiguel Equihua, Elio G. Lagunes\n\n\n\n\n\n\nNo hay resultados"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#instrucciones-para-participar",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#instrucciones-para-participar",
    "title": "Leyes de la Ciencia",
    "section": "",
    "text": "lo que hay que hacer es\n\n\n\n\nEn tu computadora ir vevox.app\nPara usar el celular instala Vevox desde la tienda de apps"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#para-ti-qué-es-la-ciencia",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#para-ti-qué-es-la-ciencia",
    "title": "Leyes de la Ciencia",
    "section": "1. Para ti, ¿qué es la ciencia?",
    "text": "1. Para ti, ¿qué es la ciencia?\n\nParticipa: vevox.app ID: 152-551-925\n\n\n\n\n\n\n\n \n\n\n\n\n(escribe de 3 a 20 palabras que reflejan tu percepción)\n\n\n\n\nEscribe una palabra y oprime enviar"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#supuestos-que-se-hacen-al-hacer-ciencia",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#supuestos-que-se-hacen-al-hacer-ciencia",
    "title": "Leyes de la Ciencia",
    "section": "Supuestos que se hacen al hacer ciencia",
    "text": "Supuestos que se hacen al hacer ciencia\n\nToda argumentación racional inicia con ciertos supuestos .\nEstos supuestos típicamente quedan implícitos en la práctica de las actividades científicas\nConviene hacerlas explícitas para darle claridad a nuestra forma de hacer ciencia."
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#qué-damos-por-sentados-cuando-hacemos-ciencia",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#qué-damos-por-sentados-cuando-hacemos-ciencia",
    "title": "Leyes de la Ciencia",
    "section": "2. ¿Qué damos por sentados cuando hacemos ciencia?",
    "text": "2. ¿Qué damos por sentados cuando hacemos ciencia?\n\nParticipa: vevox.app ID: 152-551-925\n\n\n\n\n\n\n\n \n\n\n\n\n(escribe de 3 a 20 palabras que reflejan tu percepción)\n\n\n\n\nEscribe una palabra y oprime enviar"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#algunos-otros-corolarios-interesantes",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#algunos-otros-corolarios-interesantes",
    "title": "Leyes de la Ciencia",
    "section": "Algunos otros corolarios interesantes",
    "text": "Algunos otros corolarios interesantes\n\nLa naturaleza es comprensible . Einstein afirmaba que: la cosa más incomprensible del universo es que sea comprensible.\nLa naturaleza es uniforme . Es decir los procesos y patrones observados sólo en una escala limitada se mantendrán universalmente (esto es obviamente imprescindible en ciencias como la Astronomía).\n\n¿Qué pasa con este supuesto en ciencias como la Ecología, la Psicología o las Ciencias sociales? De paso, hay que notar que este supuesto implica la homogeneidad del material experimental.\n\nLa causalidad existe . El principio de causalidad es la noción que consiste en que “cada evento (o fenómeno) natural se supone tiene una causa, de modo que si tal situación causal puede ser restituida, el evento será duplicado” (Underwood1957)."
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#cómo-debe-interpretarse-esto",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#cómo-debe-interpretarse-esto",
    "title": "Leyes de la Ciencia",
    "section": "3. ¿Cómo debe interpretarse esto?",
    "text": "3. ¿Cómo debe interpretarse esto?\n\nParticipa: vevox.app ID: 152-551-925\n\n\n\n\n\n\n\n \n\n\n\n\n\n90% de las semillas en un grupo tratado germinan.\n20% lo hacen en el grupo control.\n\n\n\n\n\nElije la respuesta que consideres más apropiada"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#qué-tan-de-acuerdo-estás-con-la-siguiente-aseveración",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#qué-tan-de-acuerdo-estás-con-la-siguiente-aseveración",
    "title": "Leyes de la Ciencia",
    "section": "4. ¿Qué tan de acuerdo estás con la siguiente aseveración?",
    "text": "4. ¿Qué tan de acuerdo estás con la siguiente aseveración?\n\nParticipa: vevox.app ID: 152-551-925\n\n“La causalidad implica correlación”"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#causalidad-finita-y-desprecio",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#causalidad-finita-y-desprecio",
    "title": "Leyes de la Ciencia",
    "section": "Causalidad finita y desprecio…",
    "text": "Causalidad finita y desprecio…\n\nPara Bachelard, uno de los signos distintivos del espíritu científico y del espíritu filosófico es el derecho a despreciar . Para él, el espíritu científico explicita clara y distintamente este derecho a despreciar lo despreciable\nDerecho que incansablemente el espíritu filosófico le rehúsa.\nPara ilustrar esto, recurre a Ostwald:\n\n“Cualquiera que sea el fenómeno considerado, siempre hay un número extremadamente grande de circunstancias que no tienen influencia mesurable sobre él”.\n¿Cómo influye el color de un proyectil en sus propiedades balísticas?"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#conoces-alguna-metodología-científica-para-describir-y-analizar-estructuras-de-relación-causa-efecto",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#conoces-alguna-metodología-científica-para-describir-y-analizar-estructuras-de-relación-causa-efecto",
    "title": "Leyes de la Ciencia",
    "section": "5. ¿Conoces alguna metodología científica para describir y analizar estructuras de relación causa efecto?",
    "text": "5. ¿Conoces alguna metodología científica para describir y analizar estructuras de relación causa efecto?\n\nParticipa: vevox.app ID: 152-551-925"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#cuáles-son-los-aspectos-clave-para-diseñar-un-experimentoestudio",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#cuáles-son-los-aspectos-clave-para-diseñar-un-experimentoestudio",
    "title": "Leyes de la Ciencia",
    "section": "6 ¿Cuáles son los aspectos CLAVE para diseñar un experimento/estudio?",
    "text": "6 ¿Cuáles son los aspectos CLAVE para diseñar un experimento/estudio?\n\nParticipa: vevox.app ID: 152-551-925"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html#section-5",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html#section-5",
    "title": "Leyes de la Ciencia",
    "section": "",
    "text": "M3-Causalidad"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "M3 - Diseño de Experimentos",
    "section": "",
    "text": "Bienvenidos al Módulo 3 de estadística\n\n\n\n\n\n\noperación\n\n\n\n\n\n\n\n\n\n27 ene 2025\n\n\nMiguel Equihua, Elio Lagunes\n\n\n\n\n\n\nNo hay resultados"
  },
  {
    "objectID": "ejercicios/tareas/index.html",
    "href": "ejercicios/tareas/index.html",
    "title": "Control de Entregas",
    "section": "",
    "text": "Esta es la lista de tareas que hemos recibido y reunido en la carpeta que tenemos en Google Drive."
  },
  {
    "objectID": "ejercicios/tareas/index.html#tareas",
    "href": "ejercicios/tareas/index.html#tareas",
    "title": "Control de Entregas",
    "section": "",
    "text": "Esta es la lista de tareas que hemos recibido y reunido en la carpeta que tenemos en Google Drive."
  },
  {
    "objectID": "ejercicios/tareas/index.html#lecturas",
    "href": "ejercicios/tareas/index.html#lecturas",
    "title": "Control de Entregas",
    "section": "Lecturas",
    "text": "Lecturas\n\n\n\n\n\n\nEsta es la colección de controles de lectura que hemos recibido."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Acerca de",
    "section": "",
    "text": "Blog de clase sobre Diseño de experimentos. Es el módulo III del curso de estadística que se imparte en el Inecol."
  },
  {
    "objectID": "ejercicios.html",
    "href": "ejercicios.html",
    "title": "M3-ejercicios",
    "section": "",
    "text": "Control de Entregas\n\n\n\n\n\n\nclase\n\n\n\n\n\n\n\n\n\n14 ene 2025\n\n\nMiguel Equihua, Elio Lagunes\n\n\n\n\n\n\nNo hay resultados"
  },
  {
    "objectID": "posts/00-Bienvenida/index.html#objetivos-del-módulo-3",
    "href": "posts/00-Bienvenida/index.html#objetivos-del-módulo-3",
    "title": "Bienvenidos al Módulo 3 de estadística",
    "section": "Objetivos del Módulo 3",
    "text": "Objetivos del Módulo 3\nDurante las últimas semanas revisaron conceptos de probabilidad y matemáticas que necesitamos como un lenguaje eficiente de comunicación. También empezaron a explorar como es que se pueden analizar proposiciones sobre la existencia de asociación o incluso relaciones de dependencia entre dos variables: modelos de regresión simple. Ahora vamos a aplicar y extender estos aprendizajes para abordar el desafío de producir conocimiento que nos permita comprender como funciona el mundo. Asumir un interés en la comprensión causal requiere desarrollar las habilidades de pensamiento crítico, lo que constituye por tanto otro de los propósitos del módulo.\nUtilizaremos el lenguaje de programación R como plataforma de cómputo para el análisis de datos. Aspiramos a ofrecerles así un curso introductorio para su uso. También nos interesa acercarnos a los enfoques formales para el análisis causal actual, mediante la formulación de Grafos Acíclicos Dirigidos (DAG). Los invitamos a hacer explícitas y a dibujar las relaciones causales de sus proyectos para comprenderlas, comunicarlas y analizarlas con mayor eficiencia.\nComo ejercicio inicial les pedimos preparen y nos entreguen en una sola cuartilla la descripción de una de las preguntas de investigación que se han planteado en su proyecto de posgrado, con suficiente detalle como para comprender el asunto y la propuesta sobre como poner a prueba la idea planteada. No se trata de todo el protocolo de su proyecto de investigación. Escojan sólo un aspecto de él. Sólo lo que deseen compartir y explorar en este curso como oportunidad de aprendizaje."
  },
  {
    "objectID": "posts/00-Bienvenida/index.html#plan-de-clase",
    "href": "posts/00-Bienvenida/index.html#plan-de-clase",
    "title": "Bienvenidos al Módulo 3 de estadística",
    "section": "Plan de clase",
    "text": "Plan de clase\n\n\nCódigo\ndias &lt;- rep(NA, 31) \ndias[c(27:28, 30:31)] &lt;- \"M3 clase\"\ndias[c(29)] &lt;- \"M3 lectura\"\ndias[c(25:26)] &lt;- \"Descanso\"\n\nene &lt;- calendR(month = 1,\n        lunar = TRUE,\n        special.days = dias,\n        special.col = c(\"gray\", \"lightgreen\", \"pink\"))\n\ndias &lt;- rep(NA, 28) \ndias[c(4)] &lt;- \"M3 clase\"\ndias[c(3, 6)] &lt;- \"M3 lectura\"\ndias[7] &lt;- \"M3 Mini simposio\"\ndias[c(1, 2, 5, 8:9)] &lt;- \"Descanso\"\n\nfeb &lt;- calendR(month = 2,\n        lunar = TRUE,\n        special.days = dias,\n        special.col = c(\"gray\", \"lightgreen\", \"pink\", \"gold\"),\n        legend.pos = \"right\")\n\nene\n\n\n\n\n\n\n\n\n\nCódigo\nfeb\n\n\n\n\n\n\n\n\n\nCódigo\ncontenido &lt;- read_csv(\"contenido.csv\", col_names = TRUE, show_col_types = FALSE)\ncontenido$lectura &lt;- c(\" \", \"debate\")[contenido$lectura + 1]\n\ncontenido %&gt;% flextable(col_keys = c(\"dia\", \"lectura\", \"tema\")) %&gt;% \n  set_header_labels(values = list(dia = \"Día\", \n                                  lectura= \"Lectura\", \n                                  tema = \"Tema\")) %&gt;% \n  autofit() %&gt;% \n  theme_zebra(odd_body = c(\"lightcyan1\")) %&gt;% \n  bold(i = 1:9, j = 1)\n\n\nAactividades del Módulo 3DíaLecturaTemaLunes 27 Un lenguaje para describir modelos (diseño de experimentos y de tratamientos)Martes 28 Causalidad y modelación gráfica: Grafos Acíclicos Dirigidos (DAG)Miércoles 29debateDiseño de experimentos: hipótesis y la modelación estadísticaJueves 30 Efectos fijos y aleatorios sus implicaciones en los modelos estadísticosViernes 31 Evitar confusión por variables conocidas: Bloques aleatorizadosLunes 3debateMuestreo dentro unidades experimentales: Diseños anidadosMartes 4 Unidades experimentales múltinivel y anidadas: Diseños de Parcelas divididasJueves 6debateModelos jerárquicos (incluye medidas repetidas)Viernes 7 Feria del diseño para discutir los protocolos de los estudiantes"
  },
  {
    "objectID": "posts/00-Bienvenida/index.html#lecturas",
    "href": "posts/00-Bienvenida/index.html#lecturas",
    "title": "Bienvenidos al Módulo 3 de estadística",
    "section": "Lecturas",
    "text": "Lecturas\nComo parte de las experiencias de aprendizaje que realizaremos tenemos tres lecturas. Les pedimos que hagan una lectura crítica de los textos propuestos y que preparen un comentario que contenga sus apreciaciones en favor o en contra de los argumentos presentados. También esperamos comenten sobre las implicaciones amplias y para la práctica científica en lo general, de los argumentos que exponen los autores. Sus reacciones tendrán oportunidad de ser expuestas y debatidas en un espacio del programa del módulo 3 a lo largo de 60 minutos.\nlas lecturas son:\n\nbelief in conspiracy theories\nguide to model selection and causal inference\nSame data, different analysts"
  },
  {
    "objectID": "posts/00-Bienvenida/index.html#evaluación",
    "href": "posts/00-Bienvenida/index.html#evaluación",
    "title": "Bienvenidos al Módulo 3 de estadística",
    "section": "Evaluación",
    "text": "Evaluación\n\nEl Módulo III será evaluado a través de las tareas y controles de lectura que les pediremos que hagan conforme se desarrolle el curso. La participación en quizes y preguntas en línea será considerada como una oportunidad de mejora, aunque la no participación no se considerará para disminuir la calificación."
  },
  {
    "objectID": "posts/00-Bienvenida/index.html#estudiantes",
    "href": "posts/00-Bienvenida/index.html#estudiantes",
    "title": "Bienvenidos al Módulo 3 de estadística",
    "section": "Estudiantes",
    "text": "Estudiantes\n\n\nCódigo\nestudiantes_2024 &lt;- read_excel(\"Lista-de-alumnos-2025.xlsx\", skip = 0)\n\nestudiantes_2024 %&gt;% \n  arrange(Estudiante) %&gt;% \n  flextable(col_keys = c(\"Matrícula\", \"Estudiante\")) %&gt;%\n  bg(i = ~str_detect(Adscripción, \"baja\"), bg = \"gray80\") %&gt;% \n  autofit() %&gt;%\n  theme_vanilla()\n\n\nEstudianteCeballos Vargas Heidi DanielaChávez Sánchez Jesús OmarContreras Martínez GuadalupeElizondo Salas Andrea CarolinaFlores Zarza BrayanHernández Navarro Héctor SantiagoJiménez Acosta NinfaLeon Wilchez Yeli YesseniaMartínez Sáenz Juan PabloMorales Cid Luis RobertoMÁRQUEZ GUERRA SONIAOlmedo Blanco María del CarmenPavón Acosta DenissePizarro Ortiz Sergio CristobalPérez Morales Juan ManuelRamírez Solano María AngélicaReyes Jiménez Ottmar RaymundoRodríguez Becerra Sared HelenaTorralva Apodaca ErickValdez Ojeda Luis FernandoVargas Amaya Andrés Felipe"
  },
  {
    "objectID": "presentaciones/03-modelo-lineal/index.html#el-modelo-estadístico-lineal-generalcenter",
    "href": "presentaciones/03-modelo-lineal/index.html#el-modelo-estadístico-lineal-generalcenter",
    "title": "Modelo Estadístico Lineal",
    "section": "El modelo estadístico lineal general{center}",
    "text": "El modelo estadístico lineal general{center}\nEstructura general"
  },
  {
    "objectID": "presentaciones/03-modelo-lineal/index.html#ejemplo-de-modelo-lineal",
    "href": "presentaciones/03-modelo-lineal/index.html#ejemplo-de-modelo-lineal",
    "title": "Modelo Estadístico Lineal",
    "section": "Ejemplo de modelo lineal",
    "text": "Ejemplo de modelo lineal\n\nGanancia de peso en un grupo de orugas que declina conforme se incrementa el contenido de taninos en la dieta.\nEsta condición puede describirse en forma abreviada así:\n\nganancia de peso de cada oruga=ganancia de peso base en general+efecto del contenido de taninos en la dieta+efecto de otros factores que fluctuan aleatoriamente\nComo modelo lineal se puede escribir así :\n\\[\ny_{ij} = \\beta_0 x_0j + \\sum_{i=1}^{k}\\beta_i x_{ij} + \\varepsilon_{j(i)}  \n\\]"
  },
  {
    "objectID": "presentaciones/03-modelo-lineal/index.html#modelos-con-variables-explicativas-cualitativas",
    "href": "presentaciones/03-modelo-lineal/index.html#modelos-con-variables-explicativas-cualitativas",
    "title": "Modelo Estadístico Lineal",
    "section": "Modelos con variables explicativas cualitativas",
    "text": "Modelos con variables explicativas cualitativas\n\n\n\n\n\n\nUn agrónomo planea estudiar las tasas de producción de cuatro híbridos de trigo en tres regiones geográficas representantes de diferentes condiciones de sequía. Los sitios se escogen según la cantidad de lluvia como normal climatológica y la respuesta es el rendimiento por hectárea. Las semillas de los híbridos son asignadas aleatoriamente a los sitios.\n\n\n¿cómo piensas que se podría hacer esta aleatorización.\n\n\n\n\n¿cual sería el modelo lineal que lo podría describir?\n\n\n\n\\[\ny_{ijk} = \\mu + R_i + H_j + RH_{ij} +  \\varepsilon_{k(ij)}\n\\]"
  },
  {
    "objectID": "presentaciones/03-modelo-lineal/index.html#el-modelo-en-todo-su-esplendor",
    "href": "presentaciones/03-modelo-lineal/index.html#el-modelo-en-todo-su-esplendor",
    "title": "Modelo Estadístico Lineal",
    "section": "El modelo en todo su esplendor",
    "text": "El modelo en todo su esplendor\n\\[\n\\begin{gather*}\ny_{ijk} = \\mu + \\beta_{1k}R_{1k} + \\beta_{2k}R_{2k} + \\beta_{3k}R_{3k} + \\\\\n          \\beta_{4k}H_{1k}   + \\beta_{5k}H_{2k}   + \\beta_{6k}H_{3k}   + \\beta_{7k}H_{ik} + \\\\\n          \\beta_{8k}RH_{1k}  + \\beta_{9k}RH_{2k}  + \\beta_{10k}RH_{3k} + \\beta_{11k}RH_{ik}+ \\\\\n          \\beta_{12k}RH_{1k} + \\beta_{13k}RH_{2k} + \\beta_{14k}RH_{3k} + \\beta_{15k}RH_{ik}+\\\\\n          \\beta_{16k}RH_{1k} + \\beta_{17k}RH_{2k} + \\beta_{18k}RH_{3k} + \\beta_{19k}RH_{ik}+\n          \\varepsilon_{k(ij)}\n\\end{gather*}\n\\]"
  },
  {
    "objectID": "presentaciones/03-modelo-lineal/index.html#qué-valores-toman-las-x-las-r-y-las-h",
    "href": "presentaciones/03-modelo-lineal/index.html#qué-valores-toman-las-x-las-r-y-las-h",
    "title": "Modelo Estadístico Lineal",
    "section": "¿Qué valores toman las X, las R y las H?",
    "text": "¿Qué valores toman las X, las R y las H?\nLa forma más común de modelar datos cualitativos es:\n\n\n\n\nMediante variables usualmente llamadas factores.\nUn factor es una listas de nombres o códigos de identificación de estados o niveles mutuamente excluyentes.\nEn la modelación se requiere convertir el factor a variables indicadoras o dummy.\nHabrá tantas variables dummy como estados o niveles tenga el factor\nCada variable se construye anotando la presencia/ausencia de la condición del factor.\n\n\n\n\n\\[\nH_1 = \\left\\{\n         \\begin{align*}\n           \\text{si } \\color{red}{sí} \\text{ es híbrido del tipo } a &: 1 \\\\\n           \\text{si } \\color{red}{no} \\text{ es híbrido del tipo } a &: 0\n         \\end{align*}\n      \\right\\}\n\\]"
  },
  {
    "objectID": "presentaciones/02-leyes-de-la-ciencia/index.html",
    "href": "presentaciones/02-leyes-de-la-ciencia/index.html",
    "title": "Leyes de la Ciencia",
    "section": "",
    "text": "lo que hay que hacer es\n\n\n\n\nEn tu computadora ir vevox.app\nPara usar el celular instala Vevox desde la tienda de apps"
  },
  {
    "objectID": "presentaciones/03-modelo-lineal/index.html",
    "href": "presentaciones/03-modelo-lineal/index.html",
    "title": "Modelo Estadístico Lineal",
    "section": "",
    "text": "¿Descriptivo o comparativo?\n¿Cómo se miden las variables (escalas)?\n¿Cómo se definen los tratamientos?\n¿Cómo se asignan los tratamientos a las unidades de observación?\n¿Procesos de confusión?\n¿Se usó aleatorización en algún punto?"
  },
  {
    "objectID": "posts/04-diagramas-causales/index.html",
    "href": "posts/04-diagramas-causales/index.html",
    "title": "Diagramas Causales",
    "section": "",
    "text": "}}\n\nJudea Pearl se ha aproximado a la causalidad desde una perspectiva matemática y computacional. En ese camino retomó y dio un nuevo impulso a los llamados modelos probabilísticos gráficos en su variante de redes Bayesianas. También ha incursionado en los llamados modelos de ecuaciones estructuradas, también de la familia de los modelos gráficos. Todo ello vinculado con los Gráfos Acíclicos Dirigidos, a los que llamaremos DAG (del inglés directed acyclic graphs). Pearl y colaboradores así como otros investigadores ahora, han venido desarrollando la teoría que nos permite analizar tales DAGs para comprender los patrones de dependencia causal así como los de correlación que implica una proposición causal dada. En esta contribución buscamos mostrarles algunos elementos interesantes de esto y con ello, animarlos a estudiar estas ideas con mayor profundidad.\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n \n\n\n\n\n \n\n\nHaz click sobre la imágen para ver la presentación\n\n\n \n\n\n\n\n\n\n\n\n\nLa cuestión que se nos complicó más en la clase de hoy fue el asunto de la puerta trasera. Aquí retomo el tema alrededor de la pregunta sobre aspirina en la que nos atoramos.\nPara referencia esta son la pregunta y DAG asociados:\n\nLos autores de este ejemplo, Hernan & Robins explican lo siguiente:\n\n\n\nEl contexto de este DAG se relaciona con la práctica farmacoepidemiológica al realizar estudios observacionales del efecto de los medicamentos, con protocolos en los que se comparan los resultados de personas que toman medicamentos específicos contra los de personas que no los toman (aunque pueden, por ejemplo, tomar otro tipo de medicación). En estos estudios, los participantes o sus médicos eligen si van a tomar o no los medicamentos. Por tanto, la asignación del tratamiento dista mucho de ser aleatoria. Se suelen hacer como seguimiento una vez liberado un fármaco en el mercado. La confusión por indicación es un sesgo que se encuentra con frecuencia en estos estudios observacionales farmacoepidemiológicos de los efectos de los fármacos.\nPara obtener más ayuda, les recomendamos acercarse a dagitty, que es un sitio de aprendizaje y uso de DAGs. Ahí hay una herramienta de dibujo de DAGs y permite explorar opciones para el diseño de estudios y recibir consejos sobre la calidad de la estimación que distintos enfoques de diseño pueden ofrecer. Esta herramienta también está disponible como una biblioteca para R. Con esta herramienta produjimos este resultado.\n\n\n\n\nConstruyamos un conjunto de datos artificial que tenga las propiedades que especifica el DAG. Que sean, digamos, 1000 pacientes tomados aleatoriamente de la comunidad en nuestro vecindario.\n\n\n\n\n\n\n\n\nAhora, Cada uno de ellos puede estar afectado, en forma continua, por la arteriosclerosis, U, aunque en el ejemplo esto no es observable, pero el paciente sí tiene ese efecto encima. Lo representaremos con números que pueden ser negativos o positivos, digamos que en cero el paciente está normalmente sano, por abajo mejor salud (en cuanto a este mal) y por arria de cero tiene mayor grado del padecimiento. Para no complicarnos podemos elegir razonablemente que estos números se parezcan a una distribución normal.\nAlgo semejante ocurre con la enfermedad cardíaca, L, salvo que la agrava la presciencia de arteriosclerosis en el paciente. Digamos que la enfermedad cardíaca puede ser cero (la condición que tiene un paciente normal), menor que cero entre más sano más pequeño este valor) y los valores positivos indica que está enfermo. Además, el mal se agrava añadiendo 10 veces el grado de arteriosclerosis que padezca el paciente. Todo esto, nos lleva a estas líneas de cálculo.\n\n\n\n\n\n\n\n\nUn poquito más complicado es el factor aspirina, A. Se trata de un tratamiento que el paciente recibe o no, según su condición también lo que le haya indicado el médico. Es una variable categórica. Hay varias formas de hacerlo, pero les muestro aquí un camino que pienso es más fácil de seguir para un lector sin experiencia computacional.\nPrimero, considero que entre los 1000 pacientes algunos ya toman aspirina y otros no. La función sample de R toma muestras aleatorias de una colección de números o palabras que le demos,\n\n\n\n\n\n\n\n\nAhora, a todos los pacientes que sean detectados con enfermedad cardíaca se les indica tomar aspirina y supondremos que todos ellos la tomarán.\n\n\n\n\n\n\n\n\nFinalmente, calculamos la respuesta de los pacientes al tratamiento y a los padecimientos que lo afectan y ponemos todos los datos en una tabla, es decir un “data.frame” de tipo modernizado llamado “tibble” cuyas funcionalidad se carga con la bibliotteca “dplyr”.\n\n\n\n\n\n\n\n\nEl modelo ideal es por lo tanto:\n\\[\nY = -2 A + U\n\\]\n\n\n\n\n\n\n\n\n\n\n\n\n\nCon este procedimiento cierro la puerta trasera y logro estimar el efecto de la aspirina sin confusión.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPara animarlos a sacar provecho de la capacidad de formular y analizar DAGs en R anoto a continuación algunas líneas a manera de ejemplo, tomando el caso de la aspirina.\nPara construir el DAG hago lo siguiente. Puse algo de definición de variables que permite hacer muchas cosas, incluso doy datos sobre ubicación, pos, para que el DAG se pinte como yo quiero.\n\nlibrary(dagitty)\n\naspirina_dag &lt;- dagitty('dag{A[exposure, pos=\"1, 0\"]\n                             Y[outcome, pos=\"2, 0\"]\n                             U[unobserved, pos=\"0, 1\"]\n                             L[selected, pos=\"0, 0\"]\n                              U -&gt; L;\n                              U -&gt; Y;\n                              L -&gt; A;\n                              A -&gt; Y}') \n\nplot(aspirina_dag)\n\n\n\n\n\n\n\n\nahora averiguo que condiciones de independencia implica este grafo. Para hacerlo sin restricciones usaré un DAG sin información sobre las características de las variables.\n\nasp_dag &lt;- dagitty('dag{U -&gt; L; U -&gt; Y; L -&gt; A; A -&gt; Y}') \n\nimpliedConditionalIndependencies(asp_dag)\n\nA _||_ U | L\nL _||_ Y | A, U\n\n\nSi tengo datos, puedo poner a prueba la correspondencia del DAG con lo observado. Me parece que no le gustan los tibble a esta función\n\nlocalTests(asp_dag, as.data.frame(datos_aspirina), \"cis.pillai\")\n\n                   estimate   p.value        2.5%      97.5%\nA _||_ U | L    -0.01643180 0.6037579 -0.07834507 0.04560775\nL _||_ Y | A, U -0.01949504 0.5380431 -0.08138976 0.04254946\n\n\nSi quiero aprovechar la caracterización de las variables puedo hacer cosas como dibujar el subgrafo que corresponde con la puerta trasera\n\nplot(backDoorGraph(aspirina_dag))\n\n\n\n\n\n\n\n\n¿Qué tengo que controlar para tener una estimación adecuada del efecto directo de A en Y?\n\ntabla_dag &lt;-  tibble(Tratamiento=exposures(aspirina_dag), \n                     Respuesta = outcomes(aspirina_dag),\n                     Covariable_a_controlar = as.character(adjustmentSets(aspirina_dag, \n                                                         effect = \"direct\" ))) \n\nlibrary(flextable)\nlibrary(tidyr)\nlibrary(stringr)\ntabla_dag %&gt;%\n  pivot_longer(cols = 1:3, names_to = \"Tipo de variable\", values_to = \"Variable\") %&gt;%\n  mutate(`Tipo de variable`=str_replace_all(`Tipo de variable`, \"_\", \" \")) %&gt;% \n  flextable() %&gt;% \n  flextable::width(j = 1, width = 2)  \n\nTipo de variableVariableTratamientoARespuestaYCovariable a controlarL\n\n\n\n\n\n\n\n\\(\\newcommand{\\ci}{\\perp\\!\\!\\!\\perp\\!\\!\\!~~~}\\)\n\nLübkea K, et. al (2020). nos ofrecen el artículo Why We Should Teach Causal Inference: Examples in Linear Regression With Simulated Data. La propuesta es atractiva y vamos a ensayar hacerlo. Esta publicación, dicen los propios autores, surge de que desde hace ya algunos años se ha venido señalando la importancia de propiciar la integración de la inferencia causal (DAGs y similares) en los cursos introductorios de estadística. Judea Pearl llama a este enfoque la “revolución causal”. Con su obra El libro del Porqué ha logrado incrementar el interés en hacer esta fusión en la enseñanza de la estadística.\n\n\n\nLa influencia de este modo de pensar es tal que está provocando incluso que algunas revistas se interesen en generar guias de uso de estas ideas, por ejemplo: Control of Confounding and Reporting of Results 1n Causal Inference Studies Guidance for Authors…. En gran parte, la tradición de experimentos aleatorizados ofrece una sólida herramienta para estudiar relaciones causales. El problema, es que hay muchas disciplinas y más situaciones, en donde el enfoque de experimentos aleatorizados es inviable.\nEl hecho es que los datos observacionales son una proporción abrumadora de la materia prima para la investigación empírica. Por lo tanto es necesario que, además de adquirir las destrezas que los experimentos aleatorizado requieren, también deben aprender a pensar en una forma más amplia acerca del proceso a través del cual se generan los datos. Esto es indispensable para fortalecer habilidades críticas necesarias para estar en posibilidad de extraer conclusiones adecuadas a partir de ellos.\nUn tema importante es comprender que en la inferencia causal, además de la habilidad para observar y operar con los datos, la evaluación contrafáctica es necesaria para lograr una comprensión más profunda de lo que se puede y quizás aún más importante, lo que no se puede deducir del análisis de un conjunto de datos.\nEn la siguiente sección vamos a seguir este camino con uno de los ejemplos que nos proponen Lübkea K, et. al (2020).\nVivimos en un mundo pleno de datos observacionales multivariados. Se trata de datos en lo que también abundan los procesos que pueden generar confusión (en el sentido estadístico, además del cognitivo), y se tiene importantes dificultades para llegar a conclusiones.\n\n\nEl ejemplo de simulación que haremos ahora parte de la proposición causal:\n\nEl aprendizaje (X) tiene como efecto el conocimiento (C), y conocer provoca la comprensión (Y),\n\nAdemás actúan algunos factores exógenos (U, son el término de error en el modelo estadístico). En la vida real, el aprendizaje, el conocimiento y la comprensión pueden ser operacionalizados por algún cuestionario y estandarizados para dar la precisión necesaria al análisis.\nEl ejemplo consiste ahora en producir un conjunto de datos que cumpla, por diseño, con la descripción que acabo de hacer. En este caso utilizaremos las ecuaciones siguientes.\n\\[\n\\begin{align}\nX &= U_{X}, \\, U_{X} \\sim N(0, 1) \\\\\nC &= 5 X + U_{C}, \\, U_{C} \\sim N(0, 1) \\\\\nY &= 3 C + U_{Y}, \\, U_{Y} \\sim N(0, 1)\n\\end{align}\n\\]\nen donde N(μ, σ) indica que existen variaciones por causas no observadas que vamos a suponer generan oscilaciones aleatorias o un ruido, cuya distribución es semejante a la que produciría una distribución Normal de probabilidades. Ahora escribimos estas ecuaciones en un escript de R.\n\nset.seed(1896) # Si interesa repetir la misma secuencia de numeros aleatorios. Habilita Repetibilidad\nn &lt;- 1000 # Sample Size\n\naprender &lt;- rnorm(n)\nconocer &lt;- 5 * aprender + rnorm(n)  # Conocer depende del comportamiento de aprender\nentender &lt;- 3 * conocer + rnorm(n)  # entender depende del comportamiento de conocer\n\n# Para comodidad de cálculo junto los datos en una tabla, un \"data.frame\"\ndatos &lt;- data.frame(aprender, conocer, entender)\n\nEl DAG que describe la situación descrita lo podemos producir en R con ayuda de la biblioteca DAGitty. Con las instrucciones siguentes.\n\nlibrary(dagitty)\n\nejemplo_1_DAG &lt;- dagitty('dag{\n                     aprender -&gt; conocer\n                     conocer -&gt; entender\n\n                     aprender[exposure, pos=\"0,0\"]\n                     conocer[pos=\"1,0\"]\n                     entender[outcome, pos=\"2,0\"]}')\noptions(repr.plot.width=10, repr.plot.height=3)\npar(cex=2, lwd = 5)\nplot(ejemplo_1_DAG)\n\n\n\n\n\n\n\n\nSi optamos por no “corregir” la estimación por el efecto del mediador, Supondríamos que el efecto total del aprendizaje sobre el entendimiento no tiene sesgo. La estimación de esta relación la obtenemos con el modelo que calculamos en ejemplo_1_ecuación_1.\n\nejemplo_1_ecuacion_1 &lt;- lm(entender ~ aprender)\nsummary(ejemplo_1_ecuacion_1)$coefficients[,1:2]\n\n               Estimate Std. Error\n(Intercept) -0.02227676 0.09661146\naprender    15.12087585 0.09781602\n\n\n¿Qué piensas de este resultado? ¿El modelo es congruente con la proposición causal? Si ahora optamos por sí “corregir” los efectos considerando que el conocimiento puede estar interfiriendo la estimación del efecto total del aprendizaje sobre el entendimiento. Ahora, el modelo que da cuenta de esta nueva situación es el que calculamos en ejemplo_1_ecuación_2.\n\nejemplo_1_ecuacion_2 &lt;- lm(entender ~ aprender + conocer)\nsummary(ejemplo_1_ecuacion_2)$coefficients[,1:2]\n\n                Estimate Std. Error\n(Intercept) -0.004947807 0.03077153\naprender     0.121514701 0.16253665\nconocer      2.981736249 0.03171170\n\n\nLos resultados de esta exploración produce dos ecuaciones:\n\\[\n\\begin{align}\nX &= U_{X}, \\, U_{X} \\sim N(0, 1) \\\\\nC &= 5 X + U_{C}, \\, U_{C} \\sim N(0, 1) \\\\\nY &= 3 C + U_{Y}, \\, U_{Y} \\sim N(0, 1)\n\\end{align}\n\\]\n\\[\n\\begin{align}\nentender &= -0.022 + 15.12 \\, aprender  + \\varepsilon \\\\\nentender &= -0.005 +  0.122 \\, aprender + 2.98 \\, conocer + \\varepsilon\n\\end{align}\n\\]\n\n¿Puedes explicar qué pasó aquí?\n¿Qué relación tiene esto con lo que cabría esperar de acuerdo con as reglas de la “separación direccional”?\n¿Qué sugieren los datos del ajuste del modelo estadístico lm?\n¿Tienen relevancia el aprendizaje y el conocimiento?\n¿Cuál es el modelo adecuado dada la proposición causal considerada?\n\nPodemos utilizar a dagitty para explorar el DAG directamente de la siguiente manera. Podemos preguntarnos cuales serían las formas de separar el grafo con criterios de independencia condicional. Se trata de aplicar las tres reglas de separación direccional al grafo. Afortunadamente dagitty lo puede hacer por nosotros.\n\nimpliedConditionalIndependencies(ejemplo_1_DAG)\n\naprn _||_ entn | cncr\n\n\n¿Qué indica este resultado?\n\\[\naprender \\,\\, \\ci \\,\\, entender \\,\\, | \\,\\, conocer\n\\]\nAdemás de hacer esto por nosotros, la biblioteca dagitty nos permite poner a prueba la correspondencia de los datos con estas ideas. Lo hacemos con la función localTests.\nLa función localTests calcula el coeficiente de correlación de Pearson para cada condición considerada. El resultado incluye el valor p y el intervalo de confianza del coeficiente de correlación para cada una de las relaciones de independencias condicionales implicadas por la estructura del modelo.\nEl coeficiente de correlación de Pearson varía entre -1 y 1. El valor 0 implica que no hay correlación, mientras que -1 o 1 implica una correlación lineal perfecta.\nEl valor p de la prueba indica la probabilidad de obtener un conjunto de datos como el que se tiene, asumiendo la hipótesis de que la condición de independencia correspondiente es verdadera.\nPor lo tanto, un coeficiente de correlación cercano a 0 con un valor p alto es sugerente de que la independencia condicional indicada es congruente con el patrón detectable en los datos.\nPor el contrario, un valor alto del coeficiente de correlación con un valor p bajo sugiere que la independencia condicional considerada no es congruente con el conjunto de datos.\nLas columnas etiquetadas com 2.5% y 97,5% contienen el intervalo de confianza del 95% para el coeficiente de correlación.\nCuanto más estrecho sea el intervalo de confianza y alejado de cero resulte, más fuerte será la evidencia de que la independencia condicional que implica el DAG no se mantiene en el conjunto de datos disponible para el ensayo.\n\n# El tipo de análisis \"cis\" usa regresión lineal para poner a prueba la correlación\nejemplo_1_analisis_DAG &lt;- localTests(x=ejemplo_1_DAG, data=datos, type=\"cis\") \n\nprint(ejemplo_1_analisis_DAG)\n\n                        estimate   p.value        2.5%      97.5%\naprn _||_ entn | cncr 0.02367054 0.4549614 -0.03840997 0.08556934\n\n\nSi lo preferimos, podemos obtener una representación gráfica de estos resultados.\n\noptions(repr.plot.width=14, repr.plot.height=5)\npar(cex=1.5, lwd = 3, oma = c(1,2,1,1), mar = (c(4,2,1,1) + 0.5))\nplotLocalTestResults(ejemplo_1_analisis_DAG, col = \"blue\")"
  },
  {
    "objectID": "posts/04-diagramas-causales/index.html#ejemplo-efectos-de-sesgo-en-las-causas",
    "href": "posts/04-diagramas-causales/index.html#ejemplo-efectos-de-sesgo-en-las-causas",
    "title": "Diagramas Causales",
    "section": "",
    "text": "El ejemplo de simulación que haremos ahora parte de la proposición causal:\n\nEl aprendizaje (X) tiene como efecto el conocimiento (C), y conocer provoca la comprensión (Y),\n\nAdemás actúan algunos factores exógenos (U, son el término de error en el modelo estadístico). En la vida real, el aprendizaje, el conocimiento y la comprensión pueden ser operacionalizados por algún cuestionario y estandarizados para dar la precisión necesaria al análisis.\nEl ejemplo consiste ahora en producir un conjunto de datos que cumpla, por diseño, con la descripción que acabo de hacer. En este caso utilizaremos las ecuaciones siguientes.\n\\[\n\\begin{align}\nX &= U_{X}, \\, U_{X} \\sim N(0, 1) \\\\\nC &= 5 X + U_{C}, \\, U_{C} \\sim N(0, 1) \\\\\nY &= 3 C + U_{Y}, \\, U_{Y} \\sim N(0, 1)\n\\end{align}\n\\]\nen donde N(μ, σ) indica que existen variaciones por causas no observadas que vamos a suponer generan oscilaciones aleatorias o un ruido, cuya distribución es semejante a la que produciría una distribución Normal de probabilidades. Ahora escribimos estas ecuaciones en un escript de R.\n\nset.seed(1896) # Si interesa repetir la misma secuencia de numeros aleatorios. Habilita Repetibilidad\nn &lt;- 1000 # Sample Size\n\naprender &lt;- rnorm(n)\nconocer &lt;- 5 * aprender + rnorm(n)  # Conocer depende del comportamiento de aprender\nentender &lt;- 3 * conocer + rnorm(n)  # entender depende del comportamiento de conocer\n\n# Para comodidad de cálculo junto los datos en una tabla, un \"data.frame\"\ndatos &lt;- data.frame(aprender, conocer, entender)\n\nEl DAG que describe la situación descrita lo podemos producir en R con ayuda de la biblioteca DAGitty. Con las instrucciones siguentes.\n\nlibrary(dagitty)\n\nejemplo_1_DAG &lt;- dagitty('dag{\n                     aprender -&gt; conocer\n                     conocer -&gt; entender\n\n                     aprender[exposure, pos=\"0,0\"]\n                     conocer[pos=\"1,0\"]\n                     entender[outcome, pos=\"2,0\"]}')\noptions(repr.plot.width=10, repr.plot.height=3)\npar(cex=2, lwd = 5)\nplot(ejemplo_1_DAG)\n\n\n\n\n\n\n\n\nSi optamos por no “corregir” la estimación por el efecto del mediador, Supondríamos que el efecto total del aprendizaje sobre el entendimiento no tiene sesgo. La estimación de esta relación la obtenemos con el modelo que calculamos en ejemplo_1_ecuación_1.\n\nejemplo_1_ecuacion_1 &lt;- lm(entender ~ aprender)\nsummary(ejemplo_1_ecuacion_1)$coefficients[,1:2]\n\n               Estimate Std. Error\n(Intercept) -0.02227676 0.09661146\naprender    15.12087585 0.09781602\n\n\n¿Qué piensas de este resultado? ¿El modelo es congruente con la proposición causal? Si ahora optamos por sí “corregir” los efectos considerando que el conocimiento puede estar interfiriendo la estimación del efecto total del aprendizaje sobre el entendimiento. Ahora, el modelo que da cuenta de esta nueva situación es el que calculamos en ejemplo_1_ecuación_2.\n\nejemplo_1_ecuacion_2 &lt;- lm(entender ~ aprender + conocer)\nsummary(ejemplo_1_ecuacion_2)$coefficients[,1:2]\n\n                Estimate Std. Error\n(Intercept) -0.004947807 0.03077153\naprender     0.121514701 0.16253665\nconocer      2.981736249 0.03171170\n\n\nLos resultados de esta exploración produce dos ecuaciones:\n\\[\n\\begin{align}\nX &= U_{X}, \\, U_{X} \\sim N(0, 1) \\\\\nC &= 5 X + U_{C}, \\, U_{C} \\sim N(0, 1) \\\\\nY &= 3 C + U_{Y}, \\, U_{Y} \\sim N(0, 1)\n\\end{align}\n\\]\n\\[\n\\begin{align}\nentender &= -0.022 + 15.12 \\, aprender  + \\varepsilon \\\\\nentender &= -0.005 +  0.122 \\, aprender + 2.98 \\, conocer + \\varepsilon\n\\end{align}\n\\]\n\n¿Puedes explicar qué pasó aquí?\n¿Qué relación tiene esto con lo que cabría esperar de acuerdo con as reglas de la “separación direccional”?\n¿Qué sugieren los datos del ajuste del modelo estadístico lm?\n¿Tienen relevancia el aprendizaje y el conocimiento?\n¿Cuál es el modelo adecuado dada la proposición causal considerada?\n\nPodemos utilizar a dagitty para explorar el DAG directamente de la siguiente manera. Podemos preguntarnos cuales serían las formas de separar el grafo con criterios de independencia condicional. Se trata de aplicar las tres reglas de separación direccional al grafo. Afortunadamente dagitty lo puede hacer por nosotros.\n\nimpliedConditionalIndependencies(ejemplo_1_DAG)\n\naprn _||_ entn | cncr\n\n\n¿Qué indica este resultado?\n\\[\naprender \\,\\, \\ci \\,\\, entender \\,\\, | \\,\\, conocer\n\\]\nAdemás de hacer esto por nosotros, la biblioteca dagitty nos permite poner a prueba la correspondencia de los datos con estas ideas. Lo hacemos con la función localTests.\nLa función localTests calcula el coeficiente de correlación de Pearson para cada condición considerada. El resultado incluye el valor p y el intervalo de confianza del coeficiente de correlación para cada una de las relaciones de independencias condicionales implicadas por la estructura del modelo.\nEl coeficiente de correlación de Pearson varía entre -1 y 1. El valor 0 implica que no hay correlación, mientras que -1 o 1 implica una correlación lineal perfecta.\nEl valor p de la prueba indica la probabilidad de obtener un conjunto de datos como el que se tiene, asumiendo la hipótesis de que la condición de independencia correspondiente es verdadera.\nPor lo tanto, un coeficiente de correlación cercano a 0 con un valor p alto es sugerente de que la independencia condicional indicada es congruente con el patrón detectable en los datos.\nPor el contrario, un valor alto del coeficiente de correlación con un valor p bajo sugiere que la independencia condicional considerada no es congruente con el conjunto de datos.\nLas columnas etiquetadas com 2.5% y 97,5% contienen el intervalo de confianza del 95% para el coeficiente de correlación.\nCuanto más estrecho sea el intervalo de confianza y alejado de cero resulte, más fuerte será la evidencia de que la independencia condicional que implica el DAG no se mantiene en el conjunto de datos disponible para el ensayo.\n\n# El tipo de análisis \"cis\" usa regresión lineal para poner a prueba la correlación\nejemplo_1_analisis_DAG &lt;- localTests(x=ejemplo_1_DAG, data=datos, type=\"cis\") \n\nprint(ejemplo_1_analisis_DAG)\n\n                        estimate   p.value        2.5%      97.5%\naprn _||_ entn | cncr 0.02367054 0.4549614 -0.03840997 0.08556934\n\n\nSi lo preferimos, podemos obtener una representación gráfica de estos resultados.\n\noptions(repr.plot.width=14, repr.plot.height=5)\npar(cex=1.5, lwd = 3, oma = c(1,2,1,1), mar = (c(4,2,1,1) + 0.5))\nplotLocalTestResults(ejemplo_1_analisis_DAG, col = \"blue\")"
  }
]